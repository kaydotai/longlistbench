#!/bin/bash

# Pre-commit hook to ensure the paper compiles successfully

echo "Running pre-commit hook: Compiling paper..."

# Add common LaTeX paths on macOS
export PATH="/Library/TeX/texbin:/usr/local/texlive/2025/bin/universal-darwin:$PATH"

# Change to the paper directory
cd "$(git rev-parse --show-toplevel)/paper" || exit 1

# Run a quick compile (single pass, no bibliography update)
if make quick; then
    echo "✓ Paper compiled successfully!"
    exit 0
else
    echo "✗ Paper compilation failed!"
    echo "Please fix the compilation errors before committing."
    echo "You can skip this hook with: git commit --no-verify"
    exit 1
fi

